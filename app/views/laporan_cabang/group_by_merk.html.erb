<% unless params[:from].nil? %>
  <% unless params[:from].empty? %>
    <h2 style="font-size: 17px; position: absolute; left: 350px;"><i>Sales <%= Merk.merk_name(params[:merk_id]).first.Merk %> Categories Report Period <%= params[:from].to_date.strftime("%e %B %Y") %> - <%= params[:to].to_date.strftime("%e %B %Y") %></i></h2>
    <br /><br />
    <table border="1" id="group_by_cabang" class="display">
      <thead>
        <tr>
          <th rowspan="3"><%= Merk.merk_name(params[:merk_id]).first.Merk %> Categories	</th>
        </tr>
        <tr>
          <% @cabang_get_id_to_7.each do |cabang| %>
            <th colspan="2"><%= cabang.Cabang.gsub(/Cabang/, "") %></th>
          <% end %>
        </tr>
        <tr>
          <% (1..7).each do %>
            <th>Qty</th>
            <th>Value</th>
          <% end %>
        </tr>
      </thead>
      <tfoot>
        <tr>
          <th scope="row">Total</th>
          <% (1..14).each do  %>
            <td></td>
          <% end %>
        </tr>
      </tfoot>
      <tbody>
        <% @category_merk.each do |merk| %>
          <tr>
            <td><%= merk.NamaBrand %></td>
            <% LaporanCabang.sum_by_value_merk(2, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Narogong -->
            <% LaporanCabang.sum_by_value_merk(3, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Bali -->
            <% LaporanCabang.sum_by_value_merk(4, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Medan -->
            <% LaporanCabang.sum_by_value_merk(5, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Surabaya -->
            <% LaporanCabang.sum_by_value_merk(7, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Semarang -->
            <% LaporanCabang.sum_by_value_merk(8, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Cirebon -->
            <% LaporanCabang.sum_by_value_merk(9, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
    </br>
    <table border="1" id="group_by_cabang_2" class="display">
      <thead>
        <tr>
          <th rowspan="3"><%= Merk.merk_name(params[:merk_id]).first.Merk %> Categories	</th>
        </tr>
        <tr>
          <% @cabang_get_id_to_22.each do |cabang| %>
            <th colspan="2"><%= cabang.Cabang.gsub(/Cabang/, "") %></th>
          <% end %>
        </tr>
        <tr>
          <% (1..6).each do %>
            <th>Qty</th>
            <th>Value</th>
          <% end %>
        </tr>
      </thead>
      <tfoot>
        <tr>
          <th scope="row">Total</th>
          <% (1..12).each do  %>
            <td></td>
          <% end %>
        </tr>
      </tfoot>
      <tbody>
        <% @category_merk.each do |merk| %>
          <tr>
            <td><%= merk.NamaBrand %></td>
            <!-- Yogyakarta -->
            <% LaporanCabang.sum_by_value_merk(10, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Palembang -->
            <% LaporanCabang.sum_by_value_merk(11, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Lampung -->
            <% LaporanCabang.sum_by_value_merk(13, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Makasar -->
            <% LaporanCabang.sum_by_value_merk(19, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Pekanbaru -->
            <% LaporanCabang.sum_by_value_merk(20, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
            <!-- Jember -->
            <% LaporanCabang.sum_by_value_merk(22, merk.KodeBrand, params[:from], params[:to]).each do |a| %>
              <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
              <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>
  </br>
  <div class="offset3"><label>There are some reports that you may want to show, please click the button below</label></div>
  <div class="offset4">
    <div class="form-inline">
      <%= link_to "Customer", laporan_cabang_group_by_merk_customer_path(:merk_id => params[:merk_id],:from => params[:from], 
        :to => params[:to] ), :method => :get, :class=>"btn btn-info" %>
      <%= link_to "Size", laporan_cabang_group_by_merk_size_path(:merk_id => params[:merk_id], :from => params[:from], 
        :to => params[:to] ), :method => :get, :class=>"btn btn-info" %>
      <%= link_to "Type", laporan_cabang_group_by_merk_type_path(:merk_id => params[:merk_id], :from => params[:from], 
        :to => params[:to] ), :method => :get, :class=>"btn btn-info" %>
      <%= link_to "Compare", laporan_cabang_group_categories_comparison_path(:merk_id => params[:merk_id], :from => params[:from], 
        :to => params[:to]), :method => :get,	:class=>"btn btn-info" %>
    </div>
  </div>
<% end %>
<br />
<label>Do you want to export to Excel? <%= link_to 'Export', url_for(:format => 'xls', :from => params[:from], :to => params[:to], 
    :merk_id => params[:merk_id]), :class=>"btn btn-info" %></label>
