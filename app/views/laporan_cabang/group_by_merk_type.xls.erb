<h2 style="font-size: 17px; position: absolute; left: 350px;"><i>Sales <%= Merk.merk_name(params[:merk_id]).first.Merk %> Brand Type Report Period <%= params[:from].to_date.strftime("%e %B %Y") %> - <%= params[:to].to_date.strftime("%e %B %Y") %></i></h2>
<br />
</form>
<br />
<table id="group_by_cabang" class="display">
  <thead>
    <tr>
      <th rowspan="3"><%= Merk.merk_name(params[:merk_id]).first.Merk %> Type</th>
    </tr>
    <tr>
      <% Cabang.get_id.each do |cabang| %>
        <th colspan="2"><%= cabang.Cabang.gsub(/Cabang/, "") %></th>
      <% end %>
    </tr>
    <tr>
      <% (1..7).each do %>
        <th>Qty</th>
        <th>Value</th>
      <% end %>
    </tr>
  </thead>
  <tfoot>
    <tr>
      <th scope="row">Total</th>
      <% (1..14).each do  %>
        <td></td>
      <% end %>
    </tr>
  </tfoot>
  <tbody>
    <% @product.each do |product| %>
      <tr>
        <td><%= product.Namaroduk %></td>
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 2, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Narogong -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 3, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Bali -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 4, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Medan -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 5, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Surabaya -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 7, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Semarang -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 8, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Cirebon -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 9, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Yogyakarta -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 10, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Palembang -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 11, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Lampung -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 13, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Makasar -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 19, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Pekanbaru -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 20, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
        <!-- Jember -->
        <% LaporanCabang.sum_of_brand_type(params[:merk_id], 22, product.KodeProduk, params[:from], params[:to]).each do |a| %>
          <td><%= a.sum_jumlah.nil? ? "0" : a.sum_jumlah.to_i %></td>
          <td><%= a.sum_harganetto2.nil? ? "0" : currency(a.sum_harganetto2) %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
