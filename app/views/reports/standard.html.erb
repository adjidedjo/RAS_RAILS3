<% unless params[:from].nil? %>
  <% unless params[:from].empty? %>
    <div class="row-fluid">
      <div class="offset4">
        <div class="block-content collapse in">
          <h2 style="font-size: 17px;"><i>Sales Standard Report Period <%= params[:from].to_date.strftime("%e %B %Y") %> - <%= params[:to].to_date.strftime("%e %B %Y") %></i></h2>
        </div>
      </div>
    </div>
    <div class="row-fluid">
      <div class="offset0">
        <div class="span5">
          <!-- block -->
          <div class="block">
            <div class="navbar navbar-inner block-header">
              <div class="muted pull-left">Search Parameters</div>
              <div class="pull-right"><span class="badge badge-info"></span>

              </div>
            </div>
            <div class="block-content collapse in">
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th>Brand</th>
                    <th>Type</th>
                    <th>Article</th>
                    <th>Fabric</th>
                    <th>Size</th>
                    <th>Group</th>
                    <th>Group</th>
                    
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><%= params[:brand].nil? ? "" : params[:brand] %></td>
                    <td><%= params[:type].nil? ? "" : params[:type] %></td>
                    <td><%= params[:article].nil? ? "" : Artikel.artikel_name(params[:article]).first.Produk %></td>
                    <td><%= params[:fabric].nil? ? "" : Kain.kain_name_from_code(params[:fabric]).first.NamaKain %></td>
                    <td><%= params[:size_type] == 'T' ? 'Special Size' : 'Standard Size' %></td>
                    <td><%= params[:group_by] %></td>
                    <td><%= params[:branch] %></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <!-- /block -->
        </div>
      </div>
    </div>
    <div class="row-fluid">
      <div class="offset8">
        <label>If you want to repeat your filter, please click <%= link_to 'New Filter', 
            reports_first_filter_path, {:class => "btn btn-primary"} %> or change your 
          <a href="#myModal" role="button" class="btn btn-primary" data-toggle="modal">Group By</a>
          <div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <%= render 'modalbox' %>
          </div>
        </label>
      </div>
    </div>
		<div class="row-fluid">
			<div class="block-content collapse in">
				<label>
					<%= link_to 'Export to Excel', url_for(:format => 'xls', :from => params[:from], :group_by => params[:group_by],
						:to => params[:to], :brand => params[:brand], :type => params[:type], :article => params[:article], :fabric => params[:fabric],
						:size_type => params[:size_type], :branch => params[:branch]), 
						:class=>"btn btn-info" %>
				</label>
			</div>
		</div>
    <br />
    <div class="row-fluid">
      <div class="block-content collapse in">
        <table border="1" id="standard_analyze" class="display" cellspacing="0" cellpadding="3" width="100%">
          <thead>
            <tr>
              <% if params[:group_by] == 'customer' %>
                <th>Customers</th>
              <% elsif params[:group_by] == 'kodeartikel' %>
                <th>Article</th>
              <% elsif params[:group_by] == 'cabang_id' %>
                <th>Branchs</th>
				         	<% end %>
            </tr>
            <tr>
		            <% Cabang.get_id.each do |cabang_name| %>
				        	 <% @laporancabang.where(cabang_id: cabang_name).each do |back| %>
				        		  <% if back.nil? %>
				        			   <td>0</td>
				        		  <% else %>				        		
				        			   <td><%= back.sum_jumlah.nil? ? 0 : back.sum_jumlah %></td>
				        		  <% end %>
		            <% end %>
              <% else %>
                <th>Items Code</th>
                <th>Brand</th>
                <th>Article</th>
                <th>Fabric</th>
                <th>Length</th>
                <th>Width</th>
              <% end %>
              <% Cabang.get_id.each do |cabang_name| %>
              	<th><%= cabang_name.Cabang.gsub(/Cabang/,'') %></th>
              <% end %>
            </tr>
          </thead>
          <tfoot>
          </tfoot>
          <tbody>
            <% @laporancabang.each do |laporan| %>
              <tr>
                <% if params[:group_by] == 'customer' %>
                  <td><%= laporan.customer %></td>
                <% elsif params[:group_by] == 'kodeartikel' %>
                  <td><%= laporan.namaartikel %></td>
                <% elsif params[:group_by] == 'cabang_id' %>
                  <td><%= Cabang.find_by_id(laporan.cabang_id).Cabang.gsub(/Cabang/,'') %></td>
                <% else %>
                  <td><%= laporan.kodebrg %></td>
                  <td><%= laporan.jenisbrgdisc %></td>
                  <td><%= laporan.namaartikel %></td>
                  <td><%= laporan.namakain %></td>
                  <td><%= laporan.panjang %></td>
                  <td><%= laporan.lebar %></td>
                <% end %>
		            <% Cabang.get_id.each do |cabang_name| %>
		            	<% if @laporancabang.where(cabang_id: cabang_name, kodebrg: laporan.kodebrg).empty? %>
		            		<td>0</td>
		            	<% else %>
		            		<% @laporancabang.where(cabang_id: cabang_name, kodebrg: laporan.kodebrg).each do |uah| %>
		            			<td><%= uah.sum_jumlah %></td>
		            	  <% end %> 	
		            	<% end %>
		            <% end %>
              </tr>
            <% end %>
          </tbody>
        </table>
        </body>
        </body>
      <% end %>
    <% end %>
