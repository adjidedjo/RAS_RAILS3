<% if params[:group_by] == 'customer' %>
	<% unless params[:from].nil? %>
		<% unless params[:from].empty? %>
			<div class="row-fluid">
				<div class="offset4">
						<div class="block-content collapse in">
							<h2 style="font-size: 17px;"><i>Sales Comparison Report Period <%= params[:from].to_date.strftime("%e %B %Y") %> - <%= params[:to].to_date.strftime("%e %B %Y") %></i></h2>
						</div>
				</div>
			</div>
			<div class="row-fluid">
				<div class="offset0">
					<div class="span5">
						<!-- block -->
						<div class="block">
							<div class="navbar navbar-inner block-header">
								<div class="muted pull-left">Search Parameters</div>
								<div class="pull-right"><span class="badge badge-info"></span>

								</div>
							</div>
							<div class="block-content collapse in">
		            <table class="table table-striped">
		              <thead>
		                <tr>
		                  <th>Brand</th>
		                  <th>Type</th>
		                  <th>Article</th>
		                  <th>Fabric</th>
		                  <th>Size</th>
		                  <th>Group</th>
		                </tr>
		              </thead>
		              <tbody>
				            <tr>
						          <td><%= Merk.merk_name(params[:brand]).first.Merk %></td>
						          <td><%= params[:type].nil? ? "" : Product.product_name(params[:type]).first.Namaroduk %></td>
						          <td><%= params[:article].nil? ? "" : Artikel.artikel_name(params[:article]).first.Produk %></td>
						          <td><%= params[:fabric].nil? ? "" : Kain.kain_name_from_code(params[:fabric]).first.NamaKain %></td>
						          <td><%= params[:size_type] == 'T' ? 'Special Size' : 'Standard Size' %></td>
						          <td><%= params[:group_by] %></td>
				            </tr>
		              </tbody>
		            </table>
							</div>
						</div>
						<!-- /block -->
					</div>
				</div>
			</div>
			<div class="row-fluid">
				<div class="offset7">
					<div class="block-content collapse in">
						<label>If you want to repeat your filter, please click <%= link_to 'New Filter', 
							reports_first_filter_path, {:class => "btn btn-primary"} %> or change your 
							<a href="#myModal" role="button" class="btn btn-primary" data-toggle="modal">Group & Compare by</a>
							<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
								<%= render 'group_compare' %>
							</div>
						</label>
					</div>
				</div>
			</div>
			<br />
			<div class="row-fluid">
				<div class="block-content collapse in">
					<table border="1" id="standard_analyze" class="display" cellspacing="0" cellpadding="3" width="100%">
						<thead>
							<tr>
									<% if params[:group_by] == 'customer' %>
								  	<th rowspan="3">Customer</th>
									<% elsif params[:group_by] == 'article' %>
								  	<th rowspan="3">Article</th>
									<% else %>
								  	<th rowspan="3">Items Code</th>
									<% end %>
								<th rowspan="3">City</th>
								<th colspan="6">Comparison</th>
							</tr>
							<tr>
								<th colspan="2"><%= (params[:to].to_date - 1.month).strftime('%B')  %></th>
								<th colspan="2"><%= params[:to].to_date.strftime('%B')  %></th>
								<th colspan="2">Growth</th>
							</tr>
							<tr>
							<% (1..3).each do |a| %>
								<th>QTY</th>
								<th>Value</th>
							<% end %>
							</tr>
						</thead>
						<tfoot>
						</tfoot>
						<tbody>
							<% @customerstore.each do |laporan| %>
								<tr>
									<% if params[:group_by] == 'customer' %>
								  	<td><%= laporan.customer %></td>
									<% elsif params[:group_by] == 'article' %>
								  	<td><%= laporan.artikel %></td>
									<% else %>
								  	<td><%= laporan.kodebrg %></td>
									<% end %>
								  <td scope="row"><%= laporan.kota %></th>
										<% LaporanCabang.analysis_customer_last_year((params[:from].to_date - 1.month), (params[:to].to_date - 1.month), 
											laporan.cabang, params[:type], 
											params[:brand], params[:article], params[:fabric], params[:size], laporan.customer, params[:size_type], 
											params[:customer_modern]).each do |a| %>
											<% @value_last = a.sum_harganetto2.nil? ? 0 : a.sum_harganetto2 %>
											<% @qty_last = a.sum_jumlah.nil? ? 0 : a.sum_jumlah.to_i %>
						        	<td><%= @qty_last %></td>
						        	<td><%= currency(@value_last) %></td>
										<% end %>
										<% @value_current = laporan.sum_harga.nil? ? 0 : laporan.sum_harga %>
										<% @qty_current = laporan.sum_jumlah.nil? ? 0 : laporan.sum_jumlah.to_i %>
						        <td><%= @qty_current %></td>
						        <td><%= currency(@value_current) %></td>
										<td><%= number_to_percentage(LaporanCabang.growth(@qty_last, @qty_current), :precision => 2) %></td>
										<td><%= number_to_percentage(LaporanCabang.growth(@value_last, @value_current), :precision => 2) %></td>
								</tr>
							<% end %>
						</tbody>
					</table>
				</div>
			</div>
		<% end %>
	<% end %>
<% end %>

<% if params[:group_by] == 'kodebrg' %>
 <% unless params[:from].nil? %>
  <% unless params[:from].empty? %>
			<div class="row-fluid">
				<div class="offset4">
						<div class="block-content collapse in">
							<h2 style="font-size: 17px;"><i>Sales Comparison Report Period <%= params[:from].to_date.strftime("%e %B %Y") %> - <%= params[:to].to_date.strftime("%e %B %Y") %></i></h2>
						</div>
				</div>
			</div>
			<div class="row-fluid">
				<div class="offset0">
					<div class="span5">
						<!-- block -->
						<div class="block">
							<div class="navbar navbar-inner block-header">
								<div class="muted pull-left">Search Parameters</div>
								<div class="pull-right"><span class="badge badge-info"></span>

								</div>
							</div>
							<div class="block-content collapse in">
		            <table class="table table-striped">
		              <thead>
		                <tr>
		                  <th>Brand</th>
		                  <th>Type</th>
		                  <th>Article</th>
		                  <th>Fabric</th>
		                  <th>Size</th>
		                  <th>Group</th>
		                </tr>
		              </thead>
		              <tbody>
				            <tr>
						          <td><%= Merk.merk_name(params[:brand]).first.Merk %></td>
						          <td><%= params[:type].nil? ? "" : Product.product_name(params[:type]).first.Namaroduk %></td>
						          <td><%= params[:article].nil? ? "" : Artikel.artikel_name(params[:article]).first.Produk %></td>
						          <td><%= params[:fabric].nil? ? "" : Kain.kain_name_from_code(params[:fabric]).first.NamaKain %></td>
						          <td><%= params[:size_type] == 'T' ? 'Special Size' : 'Standard Size' %></td>
						          <td><%= params[:group_by] %></td>
				            </tr>
		              </tbody>
		            </table>
							</div>
						</div>
						<!-- /block -->
					</div>
				</div>
			</div>
		<div class="row-fluid">
			<div class="offset7">
				<div class="block-content collapse in">
					<label>If you want to repeat your filter, please click <%= link_to 'New Filter', 
						reports_first_filter_path, {:class => "btn btn-primary"} %> or change your 
						<a href="#myModal" role="button" class="btn btn-primary" data-toggle="modal">Group & Compare By</a>
						<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
							<%= render 'group_compare' %>
						</div>
					</label>
				</div>
			</div>
		</div>
		<br />
		<div class="row-fluid">
			<div class="block-content collapse in">
				<table border="1" id="standard_analyze" class="display" cellspacing="0" cellpadding="3" width="100%">
					<thead>
						<tr>
								<% if params[:group_by] == 'customer' %>
						    	<th rowspan="3">Customer</th>
								<% elsif params[:group_by] == 'article' %>
						    	<th rowspan="3">Article</th>
								<% else %>
						    	<th rowspan="3">Items Code</th>
								<% end %>
						  <th rowspan="3">City</th>
						  <th colspan="6">Comparison</th>
						</tr>
						<tr>
						  <th colspan="2"><%= (params[:to].to_date - 1.month).strftime('%B')  %></th>
						  <th colspan="2"><%= params[:to].to_date.strftime('%B')  %></th>
							<th colspan="2">Growth</th>
						</tr>
						<tr>
						<% (1..3).each do |a| %>
						  <th>QTY</th>
						  <th>Value</th>
						<% end %>
						</tr>
					</thead>
					<tfoot>
					</tfoot>
					<tbody>
						<% @customerstore.each do |laporan| %>
						  <tr>
								<% if params[:group_by] == 'customer' %>
						    	<td><%= laporan.customer %></td>
								<% elsif params[:group_by] == 'article' %>
						    	<td><%= laporan.artikel %></td>
								<% else %>
						    	<td><%= laporan.kodebrg %></td>
								<% end %>
						    <td scope="row"><%= laporan.kota %></th>
									<% LaporanCabang.analysis_customer_last_year((params[:from].to_date - 1.month), (params[:to].to_date - 1.month), 
										laporan.cabang, params[:type], 
										params[:brand], laporan.kodebrg, nil, nil, nil, params[:size_type], 
										params[:customer_modern]).each do |a| %>
										<% @value_last = a.sum_harganetto2.nil? ? 0 : a.sum_harganetto2 %>
				          	<td><%= @qty_last = a.sum_jumlah.nil? ? 0 : a.sum_jumlah.to_i %></td>
				          	<td><%= currency(@value_last) %></td>
									<% end %>
									<% @value_current = laporan.sum_harga.nil? ? 0 : laporan.sum_harga %>
				          <td><%= @qty_current = laporan.sum_jumlah.nil? ? 0 : laporan.sum_jumlah.to_i %></td>
				          <td><%= currency(@value_current) %></td>
									<td><%= number_to_percentage(LaporanCabang.growth(@qty_last, @qty_current), :precision => 2) %></td>
									<td><%= number_to_percentage(LaporanCabang.growth(@value_last, @value_current), :precision => 2) %></td>
						  </tr>
						<% end %>
					</tbody>
				</table>
			</div>
		</div>
	<% end %>
 <% end %>
<% end %>

<% if params[:group_by] == 'kodeartikel' %>
 <% unless params[:from].nil? %>
  <% unless params[:from].empty? %>
			<div class="row-fluid">
				<div class="offset4">
						<div class="block-content collapse in">
							<h2 style="font-size: 17px;"><i>Sales Comparison Report Period <%= params[:from].to_date.strftime("%e %B %Y") %> - <%= params[:to].to_date.strftime("%e %B %Y") %></i></h2>
						</div>
				</div>
			</div>
			<div class="row-fluid">
				<div class="offset0">
					<div class="span5">
						<!-- block -->
						<div class="block">
							<div class="navbar navbar-inner block-header">
								<div class="muted pull-left">Search Parameters</div>
								<div class="pull-right"><span class="badge badge-info"></span>

								</div>
							</div>
							<div class="block-content collapse in">
		            <table class="table table-striped">
		              <thead>
		                <tr>
		                  <th>Brand</th>
		                  <th>Type</th>
		                  <th>Article</th>
		                  <th>Fabric</th>
		                  <th>Size</th>
		                  <th>Group</th>
		                </tr>
		              </thead>
		              <tbody>
				            <tr>
						          <td><%= Merk.merk_name(params[:brand]).first.Merk %></td>
						          <td><%= params[:type].nil? ? "" : Product.product_name(params[:type]).first.Namaroduk %></td>
						          <td><%= params[:article].nil? ? "" : Artikel.artikel_name(params[:article]).first.Produk %></td>
						          <td><%= params[:fabric].nil? ? "" : Kain.kain_name_from_code(params[:fabric]).first.NamaKain %></td>
						          <td><%= params[:size_type] == 'T' ? 'Special Size' : 'Standard Size' %></td>
						          <td><%= params[:group_by] %></td>
				            </tr>
		              </tbody>
		            </table>
							</div>
						</div>
						<!-- /block -->
					</div>
				</div>
			</div>
		<div class="row-fluid">
			<div class="offset7">
				<div class="block-content collapse in">
					<label>If you want to repeat your filter, please click <%= link_to 'New Filter', 
						reports_first_filter_path, {:class => "btn btn-primary"} %> or change your 
						<a href="#myModal" role="button" class="btn btn-primary" data-toggle="modal">Group & Compare by</a>
						<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
							<%= render 'group_compare' %>
						</div>
					</label>
				</div>
			</div>
		</div>
		<br />
		<div class="row-fluid">
			<div class="block-content collapse in">
				<table border="1" id="standard_analyze" class="display" cellspacing="0" cellpadding="3" width="100%">
					<thead>
						<tr>
								<% if params[:group_by] == 'customer' %>
						    	<th rowspan="3">Customer</th>
								<% elsif params[:group_by] == 'kodeartikel' %>
						    	<th rowspan="3">Article</th>
								<% else %>
						    	<th rowspan="3">Items Code</th>
								<% end %>
						  <th rowspan="3">City</th>
						  <th colspan="6">Comparison</th>
						</tr>
						<tr>
						  <th colspan="2"><%= (params[:to].to_date - 1.month).strftime('%B')  %></th>
						  <th colspan="2"><%= params[:to].to_date.strftime('%B')  %></th>
							<th colspan="2">Growth</th>
						</tr>
						<tr>
						<% (1..3).each do |a| %>
						  <th>QTY</th>
						  <th>Value</th>
						<% end %>
						</tr>
					</thead>
					<tfoot>
					</tfoot>
					<tbody>
						<% @customerstore.each do |laporan| %>
						  <tr>
								<% if params[:group_by] == 'customer' %>
						    	<td><%= laporan.customer %></td>
								<% elsif params[:group_by] == 'kodeartikel' %>
						    	<td><%= Artikel.artikel_name(laporan.kodeartikel).first.nil? ? "" : Artikel.artikel_name(laporan.kodeartikel).first.Produk %></td>
								<% else %>
						    	<td><%= laporan.kodebrg %></td>
								<% end %>
						    <td scope="row"><%= laporan.kota %></th>
									<% LaporanCabang.analysis_customer_last_year((params[:from].to_date - 1.month), (params[:to].to_date - 1.month), 
										laporan.cabang, params[:type], 
										params[:brand], laporan.kodeartikel, params[:fabric], params[:size], params[:customer], params[:size_type], 
										params[:customer_modern]).each do |a| %>
										<% @value_last = a.sum_harganetto2.nil? ? 0 : a.sum_harganetto2 %>
				          	<td><%= @qty_last = a.sum_jumlah.nil? ? 0 : a.sum_jumlah.to_i %></td>
				          	<td><%= currency(@value_last) %></td>
									<% end %>
									<% @value_current = laporan.sum_harga.nil? ? 0 : laporan.sum_harga %>
				          <td><%= @qty_current = laporan.sum_jumlah.nil? ? 0 : laporan.sum_jumlah.to_i %></td>
				          <td><%= currency(@value_current) %></td>
									<td><%= number_to_percentage(LaporanCabang.growth(@qty_last, @qty_current), :precision => 2) %></td>
									<td><%= number_to_percentage(LaporanCabang.growth(@value_last, @value_current), :precision => 2) %></td>
						  </tr>
						<% end %>
					</tbody>
				</table>
			</div>
		</div>
	<% end %>
 <% end %>
<% end %>
